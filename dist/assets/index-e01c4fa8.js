import{bo as e,bp as pe,bq as ge,r as n,br as xe,bs as _e,bt as fe,bu as Se,bv as Ce,bw as ye,bx as be,by as je,bz as ve,bA as we}from"./vendor-cc8277fd.js";import{S as Ne,E as ke,a as Le,D as Ee,b as Te}from"./fluentui-icons-3d7660a4.js";import{S as p,P as Ae,T as B,a as Me,B as H,C as Ie,b as Re,D as Pe,c as qe,d as A}from"./fluentui-react-e5b42e96.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))h(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&h(d)}).observe(document,{childList:!0,subtree:!0});function l(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function h(s){if(s.ep)return;s.ep=!0;const i=l(s);fetch(s.href,i)}})();const Be="/assets/github-fab00c2d.svg",Fe="_layout_1nrkm_1",$e="_header_1nrkm_7",Oe="_headerContainer_1nrkm_12",Qe="_headerTitleContainer_1nrkm_20",Ge="_headerLogo_1nrkm_28",ze="_headerTitle_1nrkm_20",De="_headerNavList_1nrkm_37",He="_headerNavPageLink_1nrkm_43",Ue="_headerNavPageLinkActive_1nrkm_57",We="_headerNavLeftMargin_1nrkm_62",Ve="_headerRightText_1nrkm_66",Ke="_microsoftLogo_1nrkm_71",Xe="_githubLogo_1nrkm_76",S={layout:Fe,header:$e,headerContainer:Oe,headerTitleContainer:Qe,headerLogo:Ge,headerTitle:ze,headerNavList:De,headerNavPageLink:He,headerNavPageLinkActive:Ue,headerNavLeftMargin:We,headerRightText:Ve,microsoftLogo:Ke,githubLogo:Xe},Je=()=>e.jsxs("div",{className:S.layout,children:[e.jsx("header",{className:S.header,role:"banner",children:e.jsxs("div",{className:S.headerContainer,children:[e.jsx(pe,{to:"/",className:S.headerTitleContainer,children:e.jsx("h3",{className:S.headerTitle,children:"Cosmos DB MongoDB vCore + Azure OpenAI"})}),e.jsx("nav",{children:e.jsx("ul",{className:S.headerNavList,children:e.jsx("li",{className:S.headerNavLeftMargin,children:e.jsx("a",{href:"https://github.com/cosmosdb",target:"_blank",title:"Github repository link",children:e.jsx("img",{src:Be,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:S.githubLogo})})})})}),e.jsx("h4",{className:S.headerRightText,children:"CosmicWorks"})]})}),e.jsx(ge,{})]}),Ye="_container_18ti9_1",Ze="_chatRoot_18ti9_8",et="_chatContainer_18ti9_13",tt="_chatEmptyState_18ti9_21",st="_chatEmptyStateTitle_18ti9_31",nt="_chatEmptyStateSubtitle_18ti9_38",at="_chatMessageStream_18ti9_54",ot="_chatMessageGpt_18ti9_66",rt="_chatMessageGptMinWidth_18ti9_73",it="_chatInput_18ti9_78",ct="_chatAnalysisPanel_18ti9_91",lt="_chatSettingsSeparator_18ti9_99",dt="_loadingLogo_18ti9_103",ht="_commandsContainer_18ti9_107",ut="_commandButton_18ti9_112",c={container:Ye,chatRoot:Ze,chatContainer:et,chatEmptyState:tt,chatEmptyStateTitle:st,chatEmptyStateSubtitle:nt,chatMessageStream:at,chatMessageGpt:ot,chatMessageGptMinWidth:rt,chatInput:it,chatAnalysisPanel:ct,chatSettingsSeparator:lt,loadingLogo:dt,commandsContainer:ht,commandButton:ut},U="https://mongodevguideapi.livelypebble-1c099e60.eastus.azurecontainerapps.io";function mt(){var t={"Content-Type":"application/json"};return t}async function pt(t){const a=JSON.stringify(t);return await fetch(`${U}/ai`,{method:"POST",mode:"cors",headers:mt(),body:a})}function gt(t){return`${U}/content/${t}`}var w=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(w||{}),W=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(W||{}),g=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(g||{});const xt="_answerContainer_1sqax_1",_t="_answerLogo_1sqax_11",ft="_answerText_1sqax_15",St="_selected_1sqax_34",Ct="_citationLearnMore_1sqax_38",yt="_citation_1sqax_38",bt="_followupQuestionsList_1sqax_60",jt="_followupQuestionLearnMore_1sqax_64",vt="_followupQuestion_1sqax_60",wt="_supContainer_1sqax_83",Nt="_retryButton_1sqax_112",kt="_loadingdots_1sqax_134",Lt="_loading_1sqax_134",x={answerContainer:xt,answerLogo:_t,answerText:ft,selected:St,citationLearnMore:Ct,citation:yt,followupQuestionsList:bt,followupQuestionLearnMore:jt,followupQuestion:vt,supContainer:wt,retryButton:Nt,loadingdots:kt,loading:Lt};function Et(t,a,l){const h=[];let s=t.trim();if(a){let d=s.length;for(let u=s.length-1;u>=0&&s[u]!=="]";u--)if(s[u]==="["){d=u;break}s=s.substring(0,d)}return{answerHtml:[s].join(""),citations:h}}const V=()=>e.jsx(Ne,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Tt=({answer:t,isSelected:a,isStreaming:l,onCitationClicked:h,onThoughtProcessClicked:s,onSupportingContentClicked:i,onFollowupQuestionClicked:d,showFollowupQuestions:C})=>{const u=t.message,m=n.useMemo(()=>Et(u,l),[t]),_=xe.sanitize(m.answerHtml).replace(/```json/g,"<pre>").replace(/```/g,"</pre>");return e.jsxs(p,{className:`${x.answerContainer} ${a&&x.selected}`,verticalAlign:"space-between",children:[e.jsx(p.Item,{children:e.jsxs(p,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(V,{}),e.jsx("div",{})]})}),e.jsx(p.Item,{grow:!0,children:e.jsx("div",{className:x.answerText,dangerouslySetInnerHTML:{__html:_}})}),!!m.citations.length&&e.jsx(p.Item,{children:e.jsxs(p,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:x.citationLearnMore,children:"Citations:"}),m.citations.map((b,f)=>{const j=gt(b);return e.jsx("a",{className:x.citation,title:b,onClick:()=>h(j),children:`${++f}. ${b}`},f)})]})})]})},At=()=>{const t=_e({from:{opacity:0},to:{opacity:1}});return e.jsx(fe.div,{style:{...t},children:e.jsxs(p,{className:x.answerContainer,verticalAlign:"space-between",children:[e.jsx(V,{}),e.jsx(p.Item,{grow:!0,children:e.jsxs("p",{className:x.answerText,children:["Generating answer",e.jsx("span",{className:x.loadingdots})]})})]})})},Mt=({error:t,onRetry:a})=>e.jsxs(p,{className:x.answerContainer,verticalAlign:"space-between",children:[e.jsx(ke,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsxs(p.Item,{grow:!0,children:[e.jsx("p",{children:e.jsx("strong",{children:"An Error Occurred:"})}),e.jsx("p",{className:x.answerText,children:t})]}),e.jsx(Ae,{className:x.retryButton,onClick:a,text:"Retry"})]}),It="_questionInputContainer_hiipw_1",Rt="_questionInputTextArea_hiipw_12",Pt="_questionInputButtonsContainer_hiipw_17",P={questionInputContainer:It,questionInputTextArea:Rt,questionInputButtonsContainer:Pt},qt=({onSend:t,disabled:a,placeholder:l,clearOnSend:h,initQuestion:s})=>{const[i,d]=n.useState("");n.useEffect(()=>{s&&d(s)},[s]);const C=()=>{a||!i.trim()||(t(i),h&&d(""))},u=f=>{f.key==="Enter"&&!f.shiftKey&&(f.preventDefault(),C())},m=(f,j)=>{j?j.length<=1e3&&d(j):d("")};Se();const _=!1,b=a||!i.trim()||_;return e.jsxs(p,{horizontal:!0,className:P.questionInputContainer,children:[e.jsx(B,{className:P.questionInputTextArea,disabled:_,placeholder:l,multiline:!0,resizable:!1,borderless:!0,value:i,onChange:m,onKeyDown:u}),e.jsx("div",{className:P.questionInputButtonsContainer,children:e.jsx(Me,{content:"Ask question button",relationship:"label",children:e.jsx(H,{size:"large",icon:e.jsx(Le,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:b,onClick:C})})})]})},Bt="_examplesNavList_o3hyg_1",Ft="_example_o3hyg_1",$t="_exampleText_o3hyg_29",F={examplesNavList:Bt,example:Ft,exampleText:$t},Ot=({text:t,value:a,onClick:l})=>e.jsx("div",{className:F.example,onClick:()=>l(a),children:e.jsx("p",{className:F.exampleText,children:t})}),Qt=["What was the price of the product with sku `FR-R92B-58`?","What is the SKU of HL Road Frame - Black?","What is HL Road Frame?"],Gt=["Compare the impact of interest rates and GDP in financial markets.","What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance","Can you identify any correlation between oil prices and stock market trends?"],zt=({onExampleClicked:t,useGPT4V:a})=>e.jsx("ul",{className:F.examplesNavList,children:(a?Gt:Qt).map((l,h)=>e.jsx("li",{children:e.jsx(Ot,{text:l,value:l,onClick:t})},h))}),Dt="_container_1p3pb_1",Ht="_message_1p3pb_9",D={container:Dt,message:Ht},q=({message:t})=>e.jsx("div",{className:D.container,children:e.jsx("div",{className:D.message,children:t})}),Ut="_container_cfwv2_1",Wt={container:Ut},Vt=({className:t,disabled:a,onClick:l})=>e.jsx("div",{className:`${Wt.container} ${t??""}`,children:e.jsx(H,{icon:e.jsx(Ee,{}),disabled:a,onClick:l,children:"Clear chat"})}),Kt="_container_1pzrp_1",Xt={container:Kt},Jt=[{key:g.Embedding,text:"Text Embeddings"},{key:g.ImageEmbedding,text:"Image Embeddings"},{key:g.Both,text:"Text and Image embeddings"}],Yt=({updateRetrievalMode:t,updateVectorFields:a,showImageOptions:l})=>{const[h,s]=n.useState(w.Hybrid),[i,d]=n.useState(),C=(u,m)=>{m&&d(m.key);let _;m?.key==="both"?_=[g.Embedding,g.ImageEmbedding]:_=[m?.key],a(_)};return n.useEffect(()=>{a(l?[g.Embedding,g.ImageEmbedding]:[g.Embedding])},[l]),e.jsx(p,{className:Xt.container,tokens:{childrenGap:10},children:l&&[w.Vectors,w.Hybrid].includes(h)&&e.jsx(Ie,{options:Jt,onChange:C,selectedKey:i,defaultSelectedKey:g.Both,label:"Vector Fields (Multi-query vector search)"})})},Zt=()=>{const[t,a]=n.useState(!1),[l,h]=n.useState(""),[s,i]=n.useState(3),[d,C]=n.useState(w.Hybrid),[u,m]=n.useState(!0),[_,b]=n.useState(!0),[f,j]=n.useState(!1),[ts,X]=n.useState(""),[$,J]=n.useState(!1),[ss,Y]=n.useState([g.Embedding]);n.useState(!1),n.useState(!1),n.useState(W.TextAndImages);const[O,ns]=n.useState(!1),v=n.useRef(""),Q=n.useRef(null),[N,M]=n.useState(!1),[Z,ee]=n.useState(!1),[k,L]=n.useState(),[as,I]=n.useState(),[te,se]=n.useState(0),[R,G]=n.useState([]),[ne,os]=n.useState(!1),E=async r=>{v.current=r,k&&L(void 0),M(!0),I(void 0);try{const y=await pt({prompt:r,session_id:"1234"}),z=y.headers.get("content-type");if(y.body)if(z?.indexOf("text/html")!==-1||z?.indexOf("text/plain")!==-1){const T=await y.text();console.error(`Chat Error: ${T}`),L(T)}else{const T=await y.json();G([...R,[r,T]])}else throw Error("No response body")}catch(o){console.error(`Chat Error: ${o}`),L(o)}finally{M(!1)}},ae=()=>{v.current="",k&&L(void 0),I(void 0),G([]),M(!1),ee(!1)};n.useEffect(()=>Q.current?.scrollIntoView({behavior:"smooth"}),[N]);const oe=(r,o)=>{h(o||"")},re=(r,o)=>{i(parseInt(o||"3"))},ie=(r,o)=>{m(!!o)},ce=(r,o)=>{j(!!o)},le=(r,o)=>{b(!!o)},de=(r,o)=>{X(o||"")},he=(r,o)=>{J(!!o)},ue=r=>{E(r)},me=(r,o)=>{I(r),se(o)};return e.jsxs("div",{className:c.container,children:[e.jsx("div",{className:c.commandsContainer,children:e.jsx(Vt,{className:c.commandButton,onClick:ae,disabled:!v.current||N})}),e.jsxs("div",{className:c.chatRoot,children:[e.jsxs("div",{className:c.chatContainer,children:[v.current?e.jsxs("div",{className:c.chatMessageStream,children:[!Z&&R.map((r,o)=>e.jsxs("div",{children:[e.jsx(q,{message:r[0]}),e.jsx("div",{className:c.chatMessageGpt,children:e.jsx(Tt,{isStreaming:!1,answer:r[1],isSelected:te===o,onCitationClicked:y=>me(y,o),onThoughtProcessClicked:()=>{},onSupportingContentClicked:()=>{},onFollowupQuestionClicked:y=>E(y),showFollowupQuestions:$&&R.length-1===o},o)})]},o)),N&&e.jsxs(e.Fragment,{children:[e.jsx(q,{message:v.current}),e.jsx("div",{className:c.chatMessageGptMinWidth,children:e.jsx(At,{})})]}),k?e.jsxs(e.Fragment,{children:[e.jsx(q,{message:v.current}),e.jsx("div",{className:c.chatMessageGptMinWidth,children:e.jsx(Mt,{error:k.toString(),onRetry:()=>E(v.current)})})]}):null,e.jsx("div",{ref:Q})]}):e.jsxs("div",{className:c.chatEmptyState,children:[e.jsx(Te,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:c.chatEmptyStateTitle,children:"Chat with your data"}),e.jsx("h2",{className:c.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e.jsx(zt,{onExampleClicked:ue,useGPT4V:O})]}),e.jsx("div",{className:c.chatInput,children:e.jsx(qt,{clearOnSend:!0,placeholder:"Type a new question (e.g. what is product FR-R92B-58?)",disabled:N,onSend:r=>E(r)})})]}),e.jsxs(Re,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>a(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(Pe,{onClick:()=>a(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(B,{className:c.chatSettingsSeparator,defaultValue:l,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:oe}),e.jsx(qe,{className:c.chatSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:s.toString(),onChange:re}),e.jsx(B,{className:c.chatSettingsSeparator,label:"Exclude category",onChange:de}),e.jsx(A,{className:c.chatSettingsSeparator,checked:u,label:"Use semantic ranker for retrieval",onChange:ie}),e.jsx(A,{className:c.chatSettingsSeparator,checked:f,label:"Use query-contextual summaries instead of whole documents",onChange:ce,disabled:!u}),e.jsx(A,{className:c.chatSettingsSeparator,checked:$,label:"Suggest follow-up questions",onChange:he}),e.jsx(Yt,{showImageOptions:O&&ne,updateVectorFields:r=>Y(r),updateRetrievalMode:r=>C(r)}),e.jsx(A,{className:c.chatSettingsSeparator,checked:_,label:"Stream chat completion responses",onChange:le})]})]})]})};var K;K=e.jsx(Je,{});Ce();const es=ye([{path:"/",element:K,children:[{index:!0,element:e.jsx(Zt,{})},{path:"*",lazy:()=>we(()=>import("./NoPage-01ebac49.js"),["assets/NoPage-01ebac49.js","assets/vendor-cc8277fd.js","assets/fluentui-react-e5b42e96.js"])}]}]);be.createRoot(document.getElementById("root")).render(e.jsx(je.StrictMode,{children:e.jsx(ve,{router:es})}));
//# sourceMappingURL=index-e01c4fa8.js.map
